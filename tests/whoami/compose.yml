version: '3.9'

services:
  whoami:
    image: jwilder/whoami:latest
    container_name: whoami
    environment: 
        - HTTP_PORT=8000
    ports:
        - 8000:8000
    networks:
      - internal
    logging:
      driver: fluentd
      options:
        fluentd-address: 127.0.0.1:24224
        fluentd-async-connect: "true"
        tag: service.whoami
    labels:
      caddy: whoami.dev.vasandani.me
      caddy.tls: internal
      # caddy.tls.dns: cloudflare ${CLOUDFLARE_API_TOKEN}
      caddy.reverse_proxy: "{{ upstreams 8000 }}"

